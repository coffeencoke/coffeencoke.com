<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<title>Debugging Nginx configs - Coffeencoke</title>
<meta name="author" content="Matt Simpson">


<meta name="description" content="Blog for Coffeencoke - Matt Simpson - about Computer Science, Programming Languages, Community, and Entrepreneurship">

<meta name="keywords" content="Matt, Simpson, Matt Simpson, Coffeencoke, Computer Science, Programming Languages, Community, Entrepreneurship, Entrepreneur, Software Development, St. Louis, Ruby, Rails, Ruby on Rails">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="/favicon.png" rel="icon">

<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
<link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
<!--[if IE]>
    <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
<![endif]-->

</head>
<body>
  <header id='main-header'>
    <div>
      <h1><a href="/">Coffeencoke</a></h1>
      
        <h2><a href="/">Matt Simpson's blog</a></h2>
      
      <nav>
        <ul>
          <li><a  href='/'>Home</a></li>
          <li><a  href='/portfolio.html'>Portfolio</a></li>
          <li><a  class='current'  href='/blog'>Blog</a></li>
          <li><a href='http://github.com/coffeencoke'>Github</a></li>
          <li><a href='http://twitter.com/coffeencoke'>Twitter</a></li>
        </ul>
      </nav>
    </div>
  </header>
  <div id='main-content'>
    <div id='blog'>
      
<article>
  <header>
    <h1 class="entry-title">
      
      Debugging Nginx configs
      
    </h1>
    <ul class="meta">
      
      <li>Developmentefficiencygo fasterinstallnginxprogrammingservertroubleshooting</li>
      
      <li>








  



<time datetime="2013-02-24T00:00:00-06:00" pubdate data-updated="true">Feb 24<span>th</span>, 2013</time></li>
    </ul>
  </header>

  <div class="entry-content">Often when working with web applications you need to write some pretty complicated Nginx configs. For example, if you are needing to support a rails application that is hosted as a sub-domain. This will require some complicated nginx configurations for serving static files, and using the correct root directory for the main app, as well as the app served at the subdirectory. Or, if you are configuring a wordpress site, with all that caching craziness!

This post is about making it easier to develop your Nginx configurations, not about rails app served as a sub directory. That <a href="http://railsgrammer.com/2012/12/serving-rails-with-a-subdirectory-root-path/">post can be found here</a>.

<h2>1. Install Echo</h2>

<blockquote>ngx_echo - Brings "echo", "sleep", "time", "exec" and more shell-style goodies to Nginx config file.</blockquote>

It is a whole lot easier to develop your configurations when you can echo some debugging statements, especially if you're using regular expressions in your configuration.

However, unfortunately, you need to install the <code>ngx_echo</code> module when you compile and install Nginx itself. :(

This is not terribly complicated but is something I do not encourage you to do on a server that you are actually using for productive work.

Install it on your development computer!

My notes from the <a href='http://wiki.nginx.org/HttpEchoModule#Installation'>ngx_echo installation instructions</a>:

<pre>
wget http://nginx.org/download/nginx-1.2.7.tar.gz
tar -xzf nginx-1.2.7.tar.gz
wget https://nodeload.github.com/agentzh/echo-nginx-module/tar.gz/v0.42
tar -xzf v0.42
cd nginx-1.2.7
sudo ./configure --prefix=/etc/nginx --sbin-path=/usr/local/bin/nginx --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/tmp --with-http_ssl_module --with-http_gzip_static_module  --add-module=/Users/matt/tmp/echo-nginx-module-0.42
# Read the output to make sure this is what you want!
sudo make
sudo make install
</pre>

Read <a href='http://wiki.nginx.org/HttpEchoModule'>the echo documentation</a> and you will be able to see what you are configuring without having to steal a server and disable somebody's productivity.

Cheers.
</div>
</article>


    </div>
  </div>
  <footer id='main-footer'>
  <div>
    <section id='currentProfessionalInterests'>
      <h1>Current Professional Interests</h1>
      <article>
        <h2>Presenting and Contributing</h2>
        <p>To my local community here in St. Louis, Missouri.</p>
      </article>
      <article>
        <h2>Working On A Project</h2>
        <p>
          <a href='http://twitter.com/asynchrony' title='Asynchrony Twitter'>@asynchrony</a>
          by leading my team developing software.
        </p>
      </article>
      <article>
        <h2>Designing and Developing Software</h2>
        <p>
          For myself, the community, and other people.
        </p>
      </article>
      <article>
        <h2>Doing Side Work </h2>
        <p>
          for small businesses Needing software solutions.
        </p>
      </article>
      <article>
        <h2>Working on Entrepreneurial Ideas</h2>
        <p>
          of my own with my lovely wife, 
          <a href='http://twitter.com/photosbybetty' title="Betty's Twitter">@photosbybetty</a>.
        </p>
      </article>
    </section>
    <section id='upcomingEvents'>
      <h1>Upcoming Events</h1>
      <article>
        <h2>Presenting about Fear in Programming</h2>
        <p>May of 2013 - STL Ruby Meetup</p>
        <p>August of 2013 - Lambda Lounge</p>
        <p>September of 2013 - Python Group</p>
      </article>
      <article>
        <h2>Contact me</h2>
        <p>
          If you would like to talk about any of my professional interests.
        </p>
        <p>
          By 
          <a href='mailto:matt@railsgrammer.com'>Email</a>
          or on
          <a href='https://twitter.com/coffeencoke'>Twitter</a>
        </p>
      </article>
    </section>
    <section id='copyright'>
      <p>
        content of posts and pages on this site are Copyright &copy; 2013 Matt Simpson. 
      </p>
      <p>
        this site proudly uses <a href="https://github.com/mojombo/jekyll">jekyll</a>, 
        you can <a href="https://github.com/coffeencoke/coffeencoke.com">view the source on github</a>
      </p>
    </section>
  </div>
</footer>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9324092-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>



</body>

